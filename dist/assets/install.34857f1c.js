import{e as M,c as Z,a as Ut,b as B,m as $t,d as Mt,k as qt,i as q,f as Kt,g as j,r as vt,h as P,n as Y,s as Zt,j as Xt,l as R,o as gt,p as Wt,q as A,t as it,v as yt,w as Jt,V as Tt,x as Qt,L as te,B as ee,_ as U,P as ae,y as re,z as Pt,A as kt,S as mt,C as ne,D as oe,E as ie,F as se,G as ue,H as Gt,I as le,J as ce,K as ve,M as de,N as fe,O as he,Q as pe,R as ge,T as ye,U as St,W as me,X as Se,Y as be,Z as Le,$ as Vt,a0 as bt,a1 as Ie,a2 as _e,a3 as we,a4 as Ee,a5 as De,a6 as st,a7 as xe,a8 as Ne,a9 as Ae,aa as Ce,ab as Me,ac as Te,ad as Lt,ae as Pe}from"./useECharts.f2181bf2.js";var C=$t();function ke(a){var e=a.mainData,t=a.datas;t||(t={main:e},a.datasAttr={main:"data"}),a.datas=a.mainData=null,zt(e,t,a),M(t,function(r){M(e.TRANSFERABLE_METHODS,function(n){r.wrapMethod(n,Z(Ge,a))})}),e.wrapMethod("cloneShallow",Z(ze,a)),M(e.CHANGABLE_METHODS,function(r){e.wrapMethod(r,Z(Ve,a))}),Ut(t[e.dataType]===e)}function Ge(a,e){if(Oe(this)){var t=B({},C(this).datas);t[this.dataType]=e,zt(e,t,a)}else dt(e,this.dataType,C(this).mainData,a);return e}function Ve(a,e){return a.struct&&a.struct.update(),e}function ze(a,e){return M(C(e).datas,function(t,r){t!==e&&dt(t.cloneShallow(),r,e,a)}),e}function Re(a){var e=C(this).mainData;return a==null||e==null?e:C(e).datas[a]}function Be(){var a=C(this).mainData;return a==null?[{data:a}]:Mt(qt(C(a).datas),function(e){return{type:e,data:C(a).datas[e]}})}function Oe(a){return C(a).mainData===a}function zt(a,e,t){C(a).datas={},M(e,function(r,n){dt(r,n,a,t)})}function dt(a,e,t,r){C(t).datas[e]=a,C(a).mainData=t,a.dataType=e,r.struct&&(a[r.structAttr]=r.struct,r.struct[r.datasAttr[e]]=a),a.getLinkedData=Re,a.getLinkedDataAll=Be}function Fe(a){var e=a.findComponents({mainType:"legend"});!e||!e.length||a.eachSeriesByType("graph",function(t){var r=t.getCategoriesData(),n=t.getGraph(),o=n.data,i=r.mapArray(r.getName);o.filterSelf(function(s){var l=o.getItemModel(s),u=l.getShallow("category");if(u!=null){q(u)&&(u=i[u]);for(var c=0;c<e.length;c++)if(!e[c].isSelected(u))return!1}return!0})})}function je(a){var e={};a.eachSeriesByType("graph",function(t){var r=t.getCategoriesData(),n=t.getData(),o={};r.each(function(i){var s=r.getName(i);o["ec-"+s]=i;var l=r.getItemModel(i),u=l.getModel("itemStyle").getItemStyle();u.fill||(u.fill=t.getColorFromPalette(s,e)),r.setItemVisual(i,"style",u);for(var c=["symbol","symbolSize","symbolKeepAspect"],v=0;v<c.length;v++){var d=l.getShallow(c[v],!0);d!=null&&r.setItemVisual(i,c[v],d)}}),r.count()&&n.each(function(i){var s=n.getItemModel(i),l=s.getShallow("category");if(l!=null){Kt(l)&&(l=o["ec-"+l]);var u=r.getItemVisual(l,"style"),c=n.ensureUniqueItemVisual(i,"style");B(c,u);for(var v=["symbol","symbolSize","symbolKeepAspect"],d=0;d<v.length;d++)n.setItemVisual(i,v[d],r.getItemVisual(l,v[d]))}})})}function $(a){return a instanceof Array||(a=[a,a]),a}function He(a){a.eachSeriesByType("graph",function(e){var t=e.getGraph(),r=e.getEdgeData(),n=$(e.get("edgeSymbol")),o=$(e.get("edgeSymbolSize"));r.setVisual("fromSymbol",n&&n[0]),r.setVisual("toSymbol",n&&n[1]),r.setVisual("fromSymbolSize",o&&o[0]),r.setVisual("toSymbolSize",o&&o[1]),r.setVisual("style",e.getModel("lineStyle").getLineStyle()),r.each(function(i){var s=r.getItemModel(i),l=t.getEdgeByIndex(i),u=$(s.getShallow("symbol",!0)),c=$(s.getShallow("symbolSize",!0)),v=s.getModel("lineStyle").getLineStyle(),d=r.ensureUniqueItemVisual(i,"style");switch(B(d,v),d.stroke){case"source":{var p=l.node1.getVisual("style");d.stroke=p&&p.fill;break}case"target":{var p=l.node2.getVisual("style");d.stroke=p&&p.fill;break}}u[0]&&l.setVisual("fromSymbol",u[0]),u[1]&&l.setVisual("toSymbol",u[1]),c[0]&&l.setVisual("fromSymbolSize",c[0]),c[1]&&l.setVisual("toSymbolSize",c[1])})})}var ut="-->",K=function(a){return a.get("autoCurveness")||null},Rt=function(a,e){var t=K(a),r=20,n=[];if(q(t))r=t;else if(j(t)){a.__curvenessList=t;return}e>r&&(r=e);var o=r%2?r+2:r+3;n=[];for(var i=0;i<o;i++)n.push((i%2?i+1:i)/10*(i%2?-1:1));a.__curvenessList=n},H=function(a,e,t){var r=[a.id,a.dataIndex].join("."),n=[e.id,e.dataIndex].join(".");return[t.uid,r,n].join(ut)},Bt=function(a){var e=a.split(ut);return[e[0],e[2],e[1]].join(ut)},Ye=function(a,e){var t=H(a.node1,a.node2,e);return e.__edgeMap[t]},Ue=function(a,e){var t=lt(H(a.node1,a.node2,e),e),r=lt(H(a.node2,a.node1,e),e);return t+r},lt=function(a,e){var t=e.__edgeMap;return t[a]?t[a].length:0};function $e(a){!K(a)||(a.__curvenessList=[],a.__edgeMap={},Rt(a))}function qe(a,e,t,r){if(!!K(t)){var n=H(a,e,t),o=t.__edgeMap,i=o[Bt(n)];o[n]&&!i?o[n].isForward=!0:i&&o[n]&&(i.isForward=!0,o[n].isForward=!1),o[n]=o[n]||[],o[n].push(r)}}function ft(a,e,t,r){var n=K(e),o=j(n);if(!n)return null;var i=Ye(a,e);if(!i)return null;for(var s=-1,l=0;l<i.length;l++)if(i[l]===t){s=l;break}var u=Ue(a,e);Rt(e,u),a.lineStyle=a.lineStyle||{};var c=H(a.node1,a.node2,e),v=e.__curvenessList,d=o||u%2?0:1;if(i.isForward)return v[d+s];var p=Bt(c),f=lt(p,e),y=v[s+f+d];return r?o?n&&n[0]===0?(f+d)%2?y:-y:((f%2?0:1)+d)%2?y:-y:(f+d)%2?y:-y:v[s+f+d]}function Ot(a){var e=a.coordinateSystem;if(!(e&&e.type!=="view")){var t=a.getGraph();t.eachNode(function(r){var n=r.getModel();r.setLayout([+n.get("x"),+n.get("y")])}),ht(t,a)}}function ht(a,e){a.eachEdge(function(t,r){var n=vt(t.getModel().get(["lineStyle","curveness"]),-ft(t,e,r,!0),0),o=P(t.node1.getLayout()),i=P(t.node2.getLayout()),s=[o,i];+n&&s.push([(o[0]+i[0])/2-(o[1]-i[1])*n,(o[1]+i[1])/2-(i[0]-o[0])*n]),t.setLayout(s)})}function Ke(a,e){a.eachSeriesByType("graph",function(t){var r=t.get("layout"),n=t.coordinateSystem;if(n&&n.type!=="view"){var o=t.getData(),i=[];M(n.dimensions,function(d){i=i.concat(o.mapDimensionsAll(d))});for(var s=0;s<o.count();s++){for(var l=[],u=!1,c=0;c<i.length;c++){var v=o.get(i[c],s);isNaN(v)||(u=!0),l.push(v)}u?o.setItemLayout(s,n.dataToPoint(l)):o.setItemLayout(s,[NaN,NaN])}ht(o.graph,t)}else(!r||r==="none")&&Ot(t)})}function O(a){var e=a.coordinateSystem;if(e.type!=="view")return 1;var t=a.option.nodeScaleRatio,r=e.scaleX,n=e.getZoom(),o=(n-1)*t+1;return o/r}function F(a){var e=a.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),+e}var It=Math.PI,X=[];function pt(a,e,t,r){var n=a.coordinateSystem;if(!(n&&n.type!=="view")){var o=n.getBoundingRect(),i=a.getData(),s=i.graph,l=o.width/2+o.x,u=o.height/2+o.y,c=Math.min(o.width,o.height)/2,v=i.count();if(i.setLayout({cx:l,cy:u}),!!v){if(t){var d=n.pointToData(r),p=d[0],f=d[1],y=[p-l,f-u];Y(y,y),Zt(y,y,c),t.setLayout([l+y[0],u+y[1]],!0);var L=a.get(["circular","rotateLabel"]);Ft(t,L,l,u)}Ze[e](a,s,i,c,l,u,v),s.eachEdge(function(S,w){var h=vt(S.getModel().get(["lineStyle","curveness"]),ft(S,a,w),0),b=P(S.node1.getLayout()),g=P(S.node2.getLayout()),m,I=(b[0]+g[0])/2,E=(b[1]+g[1])/2;+h&&(h*=3,m=[l*h+I*(1-h),u*h+E*(1-h)]),S.setLayout([b,g,m])})}}}var Ze={value:function(a,e,t,r,n,o,i){var s=0,l=t.getSum("value"),u=Math.PI*2/(l||i);e.eachNode(function(c){var v=c.getValue("value"),d=u*(l?v:1)/2;s+=d,c.setLayout([r*Math.cos(s)+n,r*Math.sin(s)+o]),s+=d})},symbolSize:function(a,e,t,r,n,o,i){var s=0;X.length=i;var l=O(a);e.eachNode(function(v){var d=F(v);isNaN(d)&&(d=2),d<0&&(d=0),d*=l;var p=Math.asin(d/2/r);isNaN(p)&&(p=It/2),X[v.dataIndex]=p,s+=p*2});var u=(2*It-s)/i/2,c=0;e.eachNode(function(v){var d=u+X[v.dataIndex];c+=d,(!v.getLayout()||!v.getLayout().fixed)&&v.setLayout([r*Math.cos(c)+n,r*Math.sin(c)+o]),c+=d})}};function Ft(a,e,t,r){var n=a.getGraphicEl();if(!!n){var o=a.getModel(),i=o.get(["label","rotate"])||0,s=n.getSymbolPath();if(e){var l=a.getLayout(),u=Math.atan2(l[1]-r,l[0]-t);u<0&&(u=Math.PI*2+u);var c=l[0]<t;c&&(u=u-Math.PI);var v=c?"left":"right";s.setTextConfig({rotation:-u,position:v,origin:"center"});var d=s.ensureState("emphasis");B(d.textConfig||(d.textConfig={}),{position:v})}else s.setTextConfig({rotation:i*=Math.PI/180})}}function Xe(a){a.eachSeriesByType("graph",function(e){e.get("layout")==="circular"&&pt(e,"symbolSize")})}var G=it;function We(a,e,t){for(var r=a,n=e,o=t.rect,i=o.width,s=o.height,l=[o.x+i/2,o.y+s/2],u=t.gravity==null?.1:t.gravity,c=0;c<r.length;c++){var v=r[c];v.p||(v.p=Xt(i*(Math.random()-.5)+l[0],s*(Math.random()-.5)+l[1])),v.pp=P(v.p),v.edges=null}var d=t.friction==null?.6:t.friction,p=d,f,y;return{warmUp:function(){p=d*.8},setFixed:function(L){r[L].fixed=!0},setUnfixed:function(L){r[L].fixed=!1},beforeStep:function(L){f=L},afterStep:function(L){y=L},step:function(L){f&&f(r,n);for(var S=[],w=r.length,h=0;h<n.length;h++){var b=n[h];if(!b.ignoreForceLayout){var g=b.n1,m=b.n2;R(S,m.p,g.p);var I=gt(S)-b.d,E=m.w/(g.w+m.w);isNaN(E)&&(E=0),Y(S,S),!g.fixed&&G(g.p,g.p,S,E*I*p),!m.fixed&&G(m.p,m.p,S,-(1-E)*I*p)}}for(var h=0;h<w;h++){var _=r[h];_.fixed||(R(S,l,_.p),G(_.p,_.p,S,u*p))}for(var h=0;h<w;h++)for(var g=r[h],x=h+1;x<w;x++){var m=r[x];R(S,m.p,g.p);var I=gt(S);I===0&&(Wt(S,Math.random()-.5,Math.random()-.5),I=1);var N=(g.rep+m.rep)/I/I;!g.fixed&&G(g.pp,g.pp,S,N),!m.fixed&&G(m.pp,m.pp,S,-N)}for(var D=[],h=0;h<w;h++){var _=r[h];_.fixed||(R(D,_.p,_.pp),G(_.p,_.p,D,p),A(_.pp,_.p))}p=p*.992;var T=p<.01;y&&y(r,n,T),L&&L(T)}}}function Je(a){a.eachSeriesByType("graph",function(e){var t=e.coordinateSystem;if(!(t&&t.type!=="view"))if(e.get("layout")==="force"){var r=e.preservedPoints||{},n=e.getGraph(),o=n.data,i=n.edgeData,s=e.getModel("force"),l=s.get("initLayout");e.preservedPoints?o.each(function(h){var b=o.getId(h);o.setItemLayout(h,r[b]||[NaN,NaN])}):!l||l==="none"?Ot(e):l==="circular"&&pt(e,"value");var u=o.getDataExtent("value"),c=i.getDataExtent("value"),v=s.get("repulsion"),d=s.get("edgeLength"),p=j(v)?v:[v,v],f=j(d)?d:[d,d];f=[f[1],f[0]];var y=o.mapArray("value",function(h,b){var g=o.getItemLayout(b),m=yt(h,u,p);return isNaN(m)&&(m=(p[0]+p[1])/2),{w:m,rep:m,fixed:o.getItemModel(b).get("fixed"),p:!g||isNaN(g[0])||isNaN(g[1])?null:g}}),L=i.mapArray("value",function(h,b){var g=n.getEdgeByIndex(b),m=yt(h,c,f);isNaN(m)&&(m=(f[0]+f[1])/2);var I=g.getModel(),E=vt(g.getModel().get(["lineStyle","curveness"]),-ft(g,e,b,!0),0);return{n1:y[g.node1.dataIndex],n2:y[g.node2.dataIndex],d:m,curveness:E,ignoreForceLayout:I.get("ignoreForceLayout")}}),S=t.getBoundingRect(),w=We(y,L,{rect:S,gravity:s.get("gravity"),friction:s.get("friction")});w.beforeStep(function(h,b){for(var g=0,m=h.length;g<m;g++)h[g].fixed&&A(h[g].p,n.getNodeByIndex(g).getLayout())}),w.afterStep(function(h,b,g){for(var m=0,I=h.length;m<I;m++)h[m].fixed||n.getNodeByIndex(m).setLayout(h[m].p),r[o.getId(m)]=h[m].p;for(var m=0,I=b.length;m<I;m++){var E=b[m],_=n.getEdgeByIndex(m),x=E.n1.p,N=E.n2.p,D=_.getLayout();D=D?D.slice():[],D[0]=D[0]||[],D[1]=D[1]||[],A(D[0],x),A(D[1],N),+E.curveness&&(D[2]=[(x[0]+N[0])/2-(x[1]-N[1])*E.curveness,(x[1]+N[1])/2-(N[0]-x[0])*E.curveness]),_.setLayout(D)}}),e.forceLayout=w,e.preservedPoints=r,w.step()}else e.forceLayout=null})}function Qe(a,e,t){var r=B(a.getBoxLayoutParams(),{aspect:t});return Qt(r,{width:e.getWidth(),height:e.getHeight()})}function ta(a,e){var t=[];return a.eachSeriesByType("graph",function(r){var n=r.get("coordinateSystem");if(!n||n==="view"){var o=r.getData(),i=o.mapArray(function(L){var S=o.getItemModel(L);return[+S.get("x"),+S.get("y")]}),s=[],l=[];Jt(i,s,l),l[0]-s[0]===0&&(l[0]+=1,s[0]-=1),l[1]-s[1]===0&&(l[1]+=1,s[1]-=1);var u=(l[0]-s[0])/(l[1]-s[1]),c=Qe(r,e,u);isNaN(u)&&(s=[c.x,c.y],l=[c.x+c.width,c.y+c.height]);var v=l[0]-s[0],d=l[1]-s[1],p=c.width,f=c.height,y=r.coordinateSystem=new Tt;y.zoomLimit=r.get("scaleLimit"),y.setBoundingRect(s[0],s[1],v,d),y.setViewRect(c.x,c.y,p,f),y.setCenter(r.get("center"),e),y.setZoom(r.get("zoom")),t.push(y)}}),t}var _t=te.prototype,W=ee.prototype,jt=function(){function a(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return a}();(function(a){U(e,a);function e(){return a!==null&&a.apply(this,arguments)||this}return e})(jt);function J(a){return isNaN(+a.cpx1)||isNaN(+a.cpy1)}var ea=function(a){U(e,a);function e(t){var r=a.call(this,t)||this;return r.type="ec-line",r}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new jt},e.prototype.buildPath=function(t,r){J(r)?_t.buildPath.call(this,t,r):W.buildPath.call(this,t,r)},e.prototype.pointAt=function(t){return J(this.shape)?_t.pointAt.call(this,t):W.pointAt.call(this,t)},e.prototype.tangentAt=function(t){var r=this.shape,n=J(r)?[r.x2-r.x1,r.y2-r.y1]:W.tangentAt.call(this,t);return Y(n,n)},e}(ae),aa=ea,Q=["fromSymbol","toSymbol"];function wt(a){return"_"+a+"Type"}function Et(a,e,t){var r=e.getItemVisual(t,a);if(!(!r||r==="none")){var n=e.getItemVisual(t,a+"Size"),o=e.getItemVisual(t,a+"Rotate"),i=e.getItemVisual(t,a+"Offset"),s=e.getItemVisual(t,a+"KeepAspect"),l=le(n),u=ce(i||0,l),c=ve(r,-l[0]/2+u[0],-l[1]/2+u[1],l[0],l[1],null,s);return c.__specifiedRotation=o==null||isNaN(o)?void 0:+o*Math.PI/180||0,c.name=a,c}}function ra(a){var e=new aa({name:"line",subPixelOptimize:!0});return ct(e.shape,a),e}function ct(a,e){a.x1=e[0][0],a.y1=e[0][1],a.x2=e[1][0],a.y2=e[1][1],a.percent=1;var t=e[2];t?(a.cpx1=t[0],a.cpy1=t[1]):(a.cpx1=NaN,a.cpy1=NaN)}var na=function(a){U(e,a);function e(t,r,n){var o=a.call(this)||this;return o._createLine(t,r,n),o}return e.prototype._createLine=function(t,r,n){var o=t.hostModel,i=t.getItemLayout(r),s=ra(i);s.shape.percent=0,re(s,{shape:{percent:1}},o,r),this.add(s),M(Q,function(l){var u=Et(l,t,r);this.add(u),this[wt(l)]=t.getItemVisual(r,l)},this),this._updateCommonStl(t,r,n)},e.prototype.updateData=function(t,r,n){var o=t.hostModel,i=this.childOfName("line"),s=t.getItemLayout(r),l={shape:{}};ct(l.shape,s),Pt(i,l,o,r),M(Q,function(u){var c=t.getItemVisual(r,u),v=wt(u);if(this[v]!==c){this.remove(this.childOfName(u));var d=Et(u,t,r);this.add(d)}this[v]=c},this),this._updateCommonStl(t,r,n)},e.prototype.getLinePath=function(){return this.childAt(0)},e.prototype._updateCommonStl=function(t,r,n){var o=t.hostModel,i=this.childOfName("line"),s=n&&n.emphasisLineStyle,l=n&&n.blurLineStyle,u=n&&n.selectLineStyle,c=n&&n.labelStatesModels,v=n&&n.emphasisDisabled,d=n&&n.focus,p=n&&n.blurScope;if(!n||t.hasItemOption){var f=t.getItemModel(r),y=f.getModel("emphasis");s=y.getModel("lineStyle").getLineStyle(),l=f.getModel(["blur","lineStyle"]).getLineStyle(),u=f.getModel(["select","lineStyle"]).getLineStyle(),v=y.get("disabled"),d=y.get("focus"),p=y.get("blurScope"),c=kt(f)}var L=t.getItemVisual(r,"style"),S=L.stroke;i.useStyle(L),i.style.fill=null,i.style.strokeNoScale=!0,i.ensureState("emphasis").style=s,i.ensureState("blur").style=l,i.ensureState("select").style=u,M(Q,function(m){var I=this.childOfName(m);if(I){I.setColor(S),I.style.opacity=L.opacity;for(var E=0;E<mt.length;E++){var _=mt[E],x=i.getState(_);if(x){var N=x.style||{},D=I.ensureState(_),T=D.style||(D.style={});N.stroke!=null&&(T[I.__isEmptyBrush?"stroke":"fill"]=N.stroke),N.opacity!=null&&(T.opacity=N.opacity)}}I.markRedraw()}},this);var w=o.getRawValue(r);ne(this,c,{labelDataIndex:r,labelFetcher:{getFormattedLabel:function(m,I){return o.getFormattedLabel(m,I,t.dataType)}},inheritColor:S||"#000",defaultOpacity:L.opacity,defaultText:(w==null?t.getName(r):isFinite(w)?oe(w):w)+""});var h=this.getTextContent();if(h){var b=c.normal;h.__align=h.style.align,h.__verticalAlign=h.style.verticalAlign,h.__position=b.get("position")||"middle";var g=b.get("distance");j(g)||(g=[g,g]),h.__labelDistance=g}this.setTextConfig({position:null,local:!0,inside:!1}),ie(this,d,p,v)},e.prototype.highlight=function(){se(this)},e.prototype.downplay=function(){ue(this)},e.prototype.updateLayout=function(t,r){this.setLinePoints(t.getItemLayout(r))},e.prototype.setLinePoints=function(t){var r=this.childOfName("line");ct(r.shape,t),r.dirty()},e.prototype.beforeUpdate=function(){var t=this,r=t.childOfName("fromSymbol"),n=t.childOfName("toSymbol"),o=t.getTextContent();if(!r&&!n&&(!o||o.ignore))return;for(var i=1,s=this.parent;s;)s.scaleX&&(i/=s.scaleX),s=s.parent;var l=t.childOfName("line");if(!this.__dirty&&!l.__dirty)return;var u=l.shape.percent,c=l.pointAt(0),v=l.pointAt(u),d=R([],v,c);Y(d,d);function p(x,N){var D=x.__specifiedRotation;if(D==null){var T=l.tangentAt(N);x.attr("rotation",(N===1?-1:1)*Math.PI/2-Math.atan2(T[1],T[0]))}else x.attr("rotation",D)}if(r&&(r.setPosition(c),p(r,0),r.scaleX=r.scaleY=i*u,r.markRedraw()),n&&(n.setPosition(v),p(n,1),n.scaleX=n.scaleY=i*u,n.markRedraw()),o&&!o.ignore){o.x=o.y=0,o.originX=o.originY=0;var f=void 0,y=void 0,L=o.__labelDistance,S=L[0]*i,w=L[1]*i,h=u/2,b=l.tangentAt(h),g=[b[1],-b[0]],m=l.pointAt(h);g[1]>0&&(g[0]=-g[0],g[1]=-g[1]);var I=b[0]<0?-1:1;if(o.__position!=="start"&&o.__position!=="end"){var E=-Math.atan2(b[1],b[0]);v[0]<c[0]&&(E=Math.PI+E),o.rotation=E}var _=void 0;switch(o.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":_=-w,y="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":_=w,y="top";break;default:_=0,y="middle"}switch(o.__position){case"end":o.x=d[0]*S+v[0],o.y=d[1]*w+v[1],f=d[0]>.8?"left":d[0]<-.8?"right":"center",y=d[1]>.8?"top":d[1]<-.8?"bottom":"middle";break;case"start":o.x=-d[0]*S+c[0],o.y=-d[1]*w+c[1],f=d[0]>.8?"right":d[0]<-.8?"left":"center",y=d[1]>.8?"bottom":d[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":o.x=S*I+c[0],o.y=c[1]+_,f=b[0]<0?"right":"left",o.originX=-S*I,o.originY=-_;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":o.x=m[0],o.y=m[1]+_,f="center",o.originY=-_;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":o.x=-S*I+v[0],o.y=v[1]+_,f=b[0]>=0?"right":"left",o.originX=S*I,o.originY=-_;break}o.scaleX=o.scaleY=i,o.setStyle({verticalAlign:o.__verticalAlign||y,align:o.__align||f})}},e}(Gt),oa=na,ia=function(){function a(e){this.group=new Gt,this._LineCtor=e||oa}return a.prototype.updateData=function(e){var t=this;this._progressiveEls=null;var r=this,n=r.group,o=r._lineData;r._lineData=e,o||n.removeAll();var i=Dt(e);e.diff(o).add(function(s){t._doAdd(e,s,i)}).update(function(s,l){t._doUpdate(o,e,l,s,i)}).remove(function(s){n.remove(o.getItemGraphicEl(s))}).execute()},a.prototype.updateLayout=function(){var e=this._lineData;!e||e.eachItemGraphicEl(function(t,r){t.updateLayout(e,r)},this)},a.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=Dt(e),this._lineData=null,this.group.removeAll()},a.prototype.incrementalUpdate=function(e,t){this._progressiveEls=[];function r(s){!s.isGroup&&!sa(s)&&(s.incremental=!0,s.ensureState("emphasis").hoverLayer=!0)}for(var n=e.start;n<e.end;n++){var o=t.getItemLayout(n);if(tt(o)){var i=new this._LineCtor(t,n,this._seriesScope);i.traverse(r),this.group.add(i),t.setItemGraphicEl(n,i),this._progressiveEls.push(i)}}},a.prototype.remove=function(){this.group.removeAll()},a.prototype.eachRendered=function(e){de(this._progressiveEls||this.group,e)},a.prototype._doAdd=function(e,t,r){var n=e.getItemLayout(t);if(!!tt(n)){var o=new this._LineCtor(e,t,r);e.setItemGraphicEl(t,o),this.group.add(o)}},a.prototype._doUpdate=function(e,t,r,n,o){var i=e.getItemGraphicEl(r);if(!tt(t.getItemLayout(n))){this.group.remove(i);return}i?i.updateData(t,n,o):i=new this._LineCtor(t,n,o),t.setItemGraphicEl(n,i),this.group.add(i)},a}();function sa(a){return a.animators&&a.animators.length>0}function Dt(a){var e=a.hostModel,t=e.getModel("emphasis");return{lineStyle:e.getModel("lineStyle").getLineStyle(),emphasisLineStyle:t.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:e.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:e.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:t.get("disabled"),blurScope:t.get("blurScope"),focus:t.get("focus"),labelStatesModels:kt(e)}}function xt(a){return isNaN(a[0])||isNaN(a[1])}function tt(a){return a&&!xt(a[0])&&!xt(a[1])}var ua=ia,et=[],at=[],rt=[],V=he,nt=pe,Nt=Math.abs;function At(a,e,t){for(var r=a[0],n=a[1],o=a[2],i=1/0,s,l=t*t,u=.1,c=.1;c<=.9;c+=.1){et[0]=V(r[0],n[0],o[0],c),et[1]=V(r[1],n[1],o[1],c);var v=Nt(nt(et,e)-l);v<i&&(i=v,s=c)}for(var d=0;d<32;d++){var p=s+u;at[0]=V(r[0],n[0],o[0],s),at[1]=V(r[1],n[1],o[1],s),rt[0]=V(r[0],n[0],o[0],p),rt[1]=V(r[1],n[1],o[1],p);var v=nt(at,e)-l;if(Nt(v)<.01)break;var f=nt(rt,e)-l;u/=2,v<0?f>=0?s=s+u:s=s-u:f>=0?s=s-u:s=s+u}return s}function ot(a,e){var t=[],r=fe,n=[[],[],[]],o=[[],[]],i=[];e/=2,a.eachEdge(function(s,l){var u=s.getLayout(),c=s.getVisual("fromSymbol"),v=s.getVisual("toSymbol");u.__original||(u.__original=[P(u[0]),P(u[1])],u[2]&&u.__original.push(P(u[2])));var d=u.__original;if(u[2]!=null){if(A(n[0],d[0]),A(n[1],d[2]),A(n[2],d[1]),c&&c!=="none"){var p=F(s.node1),f=At(n,d[0],p*e);r(n[0][0],n[1][0],n[2][0],f,t),n[0][0]=t[3],n[1][0]=t[4],r(n[0][1],n[1][1],n[2][1],f,t),n[0][1]=t[3],n[1][1]=t[4]}if(v&&v!=="none"){var p=F(s.node2),f=At(n,d[1],p*e);r(n[0][0],n[1][0],n[2][0],f,t),n[1][0]=t[1],n[2][0]=t[2],r(n[0][1],n[1][1],n[2][1],f,t),n[1][1]=t[1],n[2][1]=t[2]}A(u[0],n[0]),A(u[1],n[2]),A(u[2],n[1])}else{if(A(o[0],d[0]),A(o[1],d[1]),R(i,o[1],o[0]),Y(i,i),c&&c!=="none"){var p=F(s.node1);it(o[0],o[0],i,p*e)}if(v&&v!=="none"){var p=F(s.node2);it(o[1],o[1],i,-p*e)}A(u[0],o[0]),A(u[1],o[1])}})}function Ct(a){return a.type==="view"}var la=function(a){U(e,a);function e(){var t=a!==null&&a.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.init=function(t,r){var n=new ge,o=new ua,i=this.group;this._controller=new ye(r.getZr()),this._controllerHost={target:i},i.add(n.group),i.add(o.group),this._symbolDraw=n,this._lineDraw=o,this._firstRender=!0},e.prototype.render=function(t,r,n){var o=this,i=t.coordinateSystem;this._model=t;var s=this._symbolDraw,l=this._lineDraw,u=this.group;if(Ct(i)){var c={x:i.x,y:i.y,scaleX:i.scaleX,scaleY:i.scaleY};this._firstRender?u.attr(c):Pt(u,c,t)}ot(t.getGraph(),O(t));var v=t.getData();s.updateData(v);var d=t.getEdgeData();l.updateData(d),this._updateNodeAndLinkScale(),this._updateController(t,r,n),clearTimeout(this._layoutTimeout);var p=t.forceLayout,f=t.get(["force","layoutAnimation"]);p&&this._startForceLayoutIteration(p,f);var y=t.get("layout");v.graph.eachNode(function(h){var b=h.dataIndex,g=h.getGraphicEl(),m=h.getModel();if(!!g){g.off("drag").off("dragend");var I=m.get("draggable");I&&g.on("drag",function(_){switch(y){case"force":p.warmUp(),!o._layouting&&o._startForceLayoutIteration(p,f),p.setFixed(b),v.setItemLayout(b,[g.x,g.y]);break;case"circular":v.setItemLayout(b,[g.x,g.y]),h.setLayout({fixed:!0},!0),pt(t,"symbolSize",h,[_.offsetX,_.offsetY]),o.updateLayout(t);break;case"none":default:v.setItemLayout(b,[g.x,g.y]),ht(t.getGraph(),t),o.updateLayout(t);break}}).on("dragend",function(){p&&p.setUnfixed(b)}),g.setDraggable(I,!!m.get("cursor"));var E=m.get(["emphasis","focus"]);E==="adjacency"&&(St(g).focus=h.getAdjacentDataIndices())}}),v.graph.eachEdge(function(h){var b=h.getGraphicEl(),g=h.getModel().get(["emphasis","focus"]);!b||g==="adjacency"&&(St(b).focus={edge:[h.dataIndex],node:[h.node1.dataIndex,h.node2.dataIndex]})});var L=t.get("layout")==="circular"&&t.get(["circular","rotateLabel"]),S=v.getLayout("cx"),w=v.getLayout("cy");v.graph.eachNode(function(h){Ft(h,L,S,w)}),this._firstRender=!1},e.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},e.prototype._startForceLayoutIteration=function(t,r){var n=this;(function o(){t.step(function(i){n.updateLayout(n._model),(n._layouting=!i)&&(r?n._layoutTimeout=setTimeout(o,16):o())})})()},e.prototype._updateController=function(t,r,n){var o=this,i=this._controller,s=this._controllerHost,l=this.group;if(i.setPointerChecker(function(u,c,v){var d=l.getBoundingRect();return d.applyTransform(l.transform),d.contain(c,v)&&!me(u,n,t)}),!Ct(t.coordinateSystem)){i.disable();return}i.enable(t.get("roam")),s.zoomLimit=t.get("scaleLimit"),s.zoom=t.coordinateSystem.getZoom(),i.off("pan").off("zoom").on("pan",function(u){Se(s,u.dx,u.dy),n.dispatchAction({seriesId:t.id,type:"graphRoam",dx:u.dx,dy:u.dy})}).on("zoom",function(u){be(s,u.scale,u.originX,u.originY),n.dispatchAction({seriesId:t.id,type:"graphRoam",zoom:u.scale,originX:u.originX,originY:u.originY}),o._updateNodeAndLinkScale(),ot(t.getGraph(),O(t)),o._lineDraw.updateLayout(),n.updateLabelLayout()})},e.prototype._updateNodeAndLinkScale=function(){var t=this._model,r=t.getData(),n=O(t);r.eachItemGraphicEl(function(o,i){o&&o.setSymbolScale(n)})},e.prototype.updateLayout=function(t){ot(t.getGraph(),O(t)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},e.prototype.remove=function(t,r){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},e.type="graph",e}(Le),ca=la;function z(a){return"_EC_"+a}var va=function(){function a(e){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=e||!1}return a.prototype.isDirected=function(){return this._directed},a.prototype.addNode=function(e,t){e=e==null?""+t:""+e;var r=this._nodesMap;if(!r[z(e)]){var n=new k(e,t);return n.hostGraph=this,this.nodes.push(n),r[z(e)]=n,n}},a.prototype.getNodeByIndex=function(e){var t=this.data.getRawIndex(e);return this.nodes[t]},a.prototype.getNodeById=function(e){return this._nodesMap[z(e)]},a.prototype.addEdge=function(e,t,r){var n=this._nodesMap,o=this._edgesMap;if(q(e)&&(e=this.nodes[e]),q(t)&&(t=this.nodes[t]),e instanceof k||(e=n[z(e)]),t instanceof k||(t=n[z(t)]),!(!e||!t)){var i=e.id+"-"+t.id,s=new Ht(e,t,r);return s.hostGraph=this,this._directed&&(e.outEdges.push(s),t.inEdges.push(s)),e.edges.push(s),e!==t&&t.edges.push(s),this.edges.push(s),o[i]=s,s}},a.prototype.getEdgeByIndex=function(e){var t=this.edgeData.getRawIndex(e);return this.edges[t]},a.prototype.getEdge=function(e,t){e instanceof k&&(e=e.id),t instanceof k&&(t=t.id);var r=this._edgesMap;return this._directed?r[e+"-"+t]:r[e+"-"+t]||r[t+"-"+e]},a.prototype.eachNode=function(e,t){for(var r=this.nodes,n=r.length,o=0;o<n;o++)r[o].dataIndex>=0&&e.call(t,r[o],o)},a.prototype.eachEdge=function(e,t){for(var r=this.edges,n=r.length,o=0;o<n;o++)r[o].dataIndex>=0&&r[o].node1.dataIndex>=0&&r[o].node2.dataIndex>=0&&e.call(t,r[o],o)},a.prototype.breadthFirstTraverse=function(e,t,r,n){if(t instanceof k||(t=this._nodesMap[z(t)]),!!t){for(var o=r==="out"?"outEdges":r==="in"?"inEdges":"edges",i=0;i<this.nodes.length;i++)this.nodes[i].__visited=!1;if(!e.call(n,t,null))for(var s=[t];s.length;)for(var l=s.shift(),u=l[o],i=0;i<u.length;i++){var c=u[i],v=c.node1===l?c.node2:c.node1;if(!v.__visited){if(e.call(n,v,l))return;s.push(v),v.__visited=!0}}}},a.prototype.update=function(){for(var e=this.data,t=this.edgeData,r=this.nodes,n=this.edges,o=0,i=r.length;o<i;o++)r[o].dataIndex=-1;for(var o=0,i=e.count();o<i;o++)r[e.getRawIndex(o)].dataIndex=o;t.filterSelf(function(s){var l=n[t.getRawIndex(s)];return l.node1.dataIndex>=0&&l.node2.dataIndex>=0});for(var o=0,i=n.length;o<i;o++)n[o].dataIndex=-1;for(var o=0,i=t.count();o<i;o++)n[t.getRawIndex(o)].dataIndex=o},a.prototype.clone=function(){for(var e=new a(this._directed),t=this.nodes,r=this.edges,n=0;n<t.length;n++)e.addNode(t[n].id,t[n].dataIndex);for(var n=0;n<r.length;n++){var o=r[n];e.addEdge(o.node1.id,o.node2.id,o.dataIndex)}return e},a}(),k=function(){function a(e,t){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=e==null?"":e,this.dataIndex=t==null?-1:t}return a.prototype.degree=function(){return this.edges.length},a.prototype.inDegree=function(){return this.inEdges.length},a.prototype.outDegree=function(){return this.outEdges.length},a.prototype.getModel=function(e){if(!(this.dataIndex<0)){var t=this.hostGraph,r=t.data.getItemModel(this.dataIndex);return r.getModel(e)}},a.prototype.getAdjacentDataIndices=function(){for(var e={edge:[],node:[]},t=0;t<this.edges.length;t++){var r=this.edges[t];r.dataIndex<0||(e.edge.push(r.dataIndex),e.node.push(r.node1.dataIndex,r.node2.dataIndex))}return e},a}(),Ht=function(){function a(e,t,r){this.dataIndex=-1,this.node1=e,this.node2=t,this.dataIndex=r==null?-1:r}return a.prototype.getModel=function(e){if(!(this.dataIndex<0)){var t=this.hostGraph,r=t.edgeData.getItemModel(this.dataIndex);return r.getModel(e)}},a.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},a}();function Yt(a,e){return{getValue:function(t){var r=this[a][e];return r.getStore().get(r.getDimensionIndex(t||"value"),this.dataIndex)},setVisual:function(t,r){this.dataIndex>=0&&this[a][e].setItemVisual(this.dataIndex,t,r)},getVisual:function(t){return this[a][e].getItemVisual(this.dataIndex,t)},setLayout:function(t,r){this.dataIndex>=0&&this[a][e].setItemLayout(this.dataIndex,t,r)},getLayout:function(){return this[a][e].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[a][e].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[a][e].getRawIndex(this.dataIndex)}}}Vt(k,Yt("hostGraph","data"));Vt(Ht,Yt("hostGraph","edgeData"));var da=va;function fa(a,e,t,r,n){for(var o=new da(r),i=0;i<a.length;i++)o.addNode(bt(a[i].id,a[i].name,i),i);for(var s=[],l=[],u=0,i=0;i<e.length;i++){var c=e[i],v=c.source,d=c.target;o.addEdge(v,d,u)&&(l.push(c),s.push(bt(Ie(c.id,null),v+" > "+d)),u++)}var p=t.get("coordinateSystem"),f;if(p==="cartesian2d"||p==="polar")f=_e(a,t);else{var y=we.get(p),L=y?y.dimensions||[]:[];Ee(L,"value")<0&&L.concat(["value"]);var S=De(a,{coordDimensions:L,encodeDefine:t.getEncode()}).dimensions;f=new st(S,t),f.initData(a)}var w=new st(["value"],t);return w.initData(l,s),n&&n(f,w),ke({mainData:f,struct:o,structAttr:"graph",datas:{node:f,edge:w},datasAttr:{node:"data",edge:"edgeData"}}),o.update(),o}var ha=function(a){U(e,a);function e(){var t=a!==null&&a.apply(this,arguments)||this;return t.type=e.type,t.hasSymbolVisual=!0,t}return e.prototype.init=function(t){a.prototype.init.apply(this,arguments);var r=this;function n(){return r._categoriesData}this.legendVisualProvider=new xe(n,n),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},e.prototype.mergeOption=function(t){a.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},e.prototype.mergeDefaultAndTheme=function(t){a.prototype.mergeDefaultAndTheme.apply(this,arguments),Ne(t,"edgeLabel",["show"])},e.prototype.getInitialData=function(t,r){var n=t.edges||t.links||[],o=t.data||t.nodes||[],i=this;if(o&&n){$e(this);var s=fa(o,n,this,!0,l);return M(s.edges,function(u){qe(u.node1,u.node2,this,u.dataIndex)},this),s.data}function l(u,c){u.wrapMethod("getItemModel",function(f){var y=i._categoriesModels,L=f.getShallow("category"),S=y[L];return S&&(S.parentModel=f.parentModel,f.parentModel=S),f});var v=Ae.prototype.getModel;function d(f,y){var L=v.call(this,f,y);return L.resolveParentPath=p,L}c.wrapMethod("getItemModel",function(f){return f.resolveParentPath=p,f.getModel=d,f});function p(f){if(f&&(f[0]==="label"||f[1]==="label")){var y=f.slice();return f[0]==="label"?y[0]="edgeLabel":f[1]==="label"&&(y[1]="edgeLabel"),y}return f}}},e.prototype.getGraph=function(){return this.getData().graph},e.prototype.getEdgeData=function(){return this.getGraph().edgeData},e.prototype.getCategoriesData=function(){return this._categoriesData},e.prototype.formatTooltip=function(t,r,n){if(n==="edge"){var o=this.getData(),i=this.getDataParams(t,n),s=o.graph.getEdgeByIndex(t),l=o.getName(s.node1.dataIndex),u=o.getName(s.node2.dataIndex),c=[];return l!=null&&c.push(l),u!=null&&c.push(u),Ce("nameValue",{name:c.join(" > "),value:i.value,noValue:i.value==null})}var v=Me({series:this,dataIndex:t,multipleSeries:r});return v},e.prototype._updateCategoriesData=function(){var t=Mt(this.option.categories||[],function(n){return n.value!=null?n:B({value:0},n)}),r=new st(["value"],this);r.initData(t),this._categoriesData=r,this._categoriesModels=r.mapArray(function(n){return r.getItemModel(n)})},e.prototype.setZoom=function(t){this.option.zoom=t},e.prototype.setCenter=function(t){this.option.center=t},e.prototype.isAnimationEnabled=function(){return a.prototype.isAnimationEnabled.call(this)&&!(this.get("layout")==="force"&&this.get(["force","layoutAnimation"]))},e.type="series.graph",e.dependencies=["grid","polar","geo","singleAxis","calendar"],e.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},e}(Te),pa=ha,ga={type:"graphRoam",event:"graphRoam",update:"none"};function ma(a){a.registerChartView(ca),a.registerSeriesModel(pa),a.registerProcessor(Fe),a.registerVisual(je),a.registerVisual(He),a.registerLayout(Ke),a.registerLayout(a.PRIORITY.VISUAL.POST_CHART_LAYOUT,Xe),a.registerLayout(Je),a.registerCoordinateSystem("graphView",{dimensions:Tt.dimensions,create:ta}),a.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},Lt),a.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},Lt),a.registerAction(ga,function(e,t,r){t.eachComponent({mainType:"series",query:e},function(n){var o=n.coordinateSystem,i=Pe(o,e,void 0,r);n.setCenter&&n.setCenter(i.center),n.setZoom&&n.setZoom(i.zoom)})})}export{oa as L,ua as a,fa as c,ma as i,ke as l};
