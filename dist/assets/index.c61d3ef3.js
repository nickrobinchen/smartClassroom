var Ue=Object.defineProperty,$e=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var re=(e,t,a)=>t in e?Ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,O=(e,t)=>{for(var a in t||(t={}))je.call(t,a)&&re(e,a,t[a]);if(se)for(var a of se(t))Ve.call(t,a)&&re(e,a,t[a]);return e},ie=(e,t)=>$e(e,Pe(t));var de=(e,t,a)=>new Promise((y,E)=>{var K=k=>{try{p(a.next(k))}catch(v){E(v)}},c=k=>{try{p(a.throw(k))}catch(v){E(v)}},p=k=>k.done?y(k.value):Promise.resolve(k.value).then(K,c);p((a=a.apply(e,t)).next())});import{e5 as me,e6 as He,e7 as Re,e8 as Xe,e9 as Ye,ea as ze,bQ as We,bX as ue,eb as qe,ec as Ge,ed as Je,ee as Qe,ef as Ze,a as Le,v as be,eg as et,c as tt,f as I,$,o as M,h as j,k as r,V as nt,l as U,j as G,z as V,B as oe,t as he,cr as at,q as fe,n as A,eh as lt,am as ct,H as Q,U as st,ei as rt,W as it,X as dt,ej as ut,al as Z,aC as ot,cq as ht,aL as ft,ek as yt,b8 as pt,a0 as ee,el as ye,w as pe,a7 as Y,ch as gt,bw as kt,O as J,em as St,ck as Kt,M as m,a2 as xt,en as Ct,cL as Lt,ag as bt,x as ge,y as ke,aW as At,cw as vt,S as Et,dL as Se,bB as _t,bC as Tt,cU as Bt,aI as Ke,bz as wt}from"./index.c77972c6.js";/* empty css                */import{u as Dt}from"./useContextMenu.61111c4c.js";var Nt=200;function Ft(e,t,a,y){var E=-1,K=Xe,c=!0,p=e.length,k=[],v=t.length;if(!p)return k;a&&(t=me(t,He(a))),y?(K=Ye,c=!1):t.length>=Nt&&(K=ze,c=!1,t=new Re(t));e:for(;++E<p;){var S=e[E],d=a==null?S:a(S);if(S=y||S!==0?S:0,c&&d===d){for(var n=v;n--;)if(t[n]===d)continue e;k.push(S)}else K(t,d,y)||k.push(S)}return k}var Mt=We(function(e,t){return ue(e)?Ft(e,qe(t,1,ue,!0)):[]}),It=Mt;function te(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((a,y)=>a+te(e,y),""):Object.keys(t).reduce((a,y)=>a+(t[y]?te(e,y):""),""):""}function Ot(e){return(t,a)=>(t&&typeof t!="string"&&(a=t,t=""),t=t?`${e}__${t}`:e,`${t}${te(t,a)}`)}function Ae(e){return[Ot(`${Ge}-${e}`)]}const xe=Symbol(),Ce=Symbol();function Ut(e,t){if(!Qe(e)||!!e[Ce])return e;const{values:a,required:y,default:E,type:K,validator:c}=e,p=a||c?k=>{let v=!1,S=[];if(a&&(S=[...a,E],v||(v=S.includes(k))),c&&(v||(v=c(k))),!v&&S.length>0){const d=[...new Set(S)].map(n=>JSON.stringify(n)).join(", ");Ze(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${d}], got value ${JSON.stringify(k)}.`)}return v}:void 0;return{type:typeof K=="object"&&Object.getOwnPropertySymbols(K).includes(xe)?K[xe]:K,required:!!y,default:E,validator:p,[Ce]:!0}}const $t=e=>Je(Object.entries(e).map(([t,a])=>[t,Ut(a,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const Pt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],jt=$t({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Vt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},mt=Le({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const a=e,y=be(""),[E]=Ae("tree-header"),K=et(),{t:c}=tt(),p=I(()=>{const n=K.headerTitle||a.title;return["mr-1","w-full",{["ml-5"]:n}]}),k=I(()=>{const{checkable:n}=a,s=[{label:c("component.tree.expandAll"),value:T.EXPAND_ALL},{label:c("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:n}];return n?[{label:c("component.tree.selectAll"),value:T.SELECT_ALL},{label:c("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:n},...s,{label:c("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:c("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:s});function v(n){var i,u,h,o;const{key:s}=n;switch(s){case T.SELECT_ALL:(i=a.checkAll)==null||i.call(a,!0);break;case T.UN_SELECT_ALL:(u=a.checkAll)==null||u.call(a,!1);break;case T.EXPAND_ALL:(h=a.expandAll)==null||h.call(a,!0);break;case T.UN_EXPAND_ALL:(o=a.expandAll)==null||o.call(a,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function S(n){t("search",n)}const d=ft(S,200);return $(()=>y.value,n=>{d(n)}),$(()=>a.searchText,n=>{n!==y.value&&(y.value=n)}),(n,s)=>(M(),j("div",{class:fe([r(E)(),"flex px-2 py-1.5 items-center"])},[r(K).headerTitle?nt(n.$slots,"headerTitle",{key:0}):U("",!0),!r(K).headerTitle&&n.title?(M(),G(r(at),{key:1,helpMessage:n.helpMessage},{default:V(()=>[oe(he(n.title),1)]),_:1},8,["helpMessage"])):U("",!0),n.search||n.toolbar?(M(),j("div",Vt,[n.search?(M(),j("div",{key:0,class:fe(r(p))},[A(r(lt),{placeholder:r(c)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":s[0]||(s[0]=i=>y.value=i)},null,8,["placeholder","value"])],2)):U("",!0),n.toolbar?(M(),G(r(ht),{key:1,onClick:s[1]||(s[1]=ot(()=>{},["prevent"]))},{overlay:V(()=>[A(r(ct),{onClick:v},{default:V(()=>[(M(!0),j(Q,null,st(r(k),i=>(M(),j(Q,{key:i.value},[A(r(rt),it(dt({key:i.value})),{default:V(()=>[oe(he(i.label),1)]),_:2},1040),i.divider?(M(),G(r(ut),{key:0})):U("",!0)],64))),128))]),_:1})]),default:V(()=>[A(r(Z),{icon:"ion:ellipsis-vertical"})]),_:1})):U("",!0)])):U("",!0)],2))}}),Ht=({icon:e})=>e?yt(e)?pt(Z,{icon:e,class:"mr-1"}):Z:null;function Rt(e,t){function a(d){const n=[],s=d||r(e),{key:i,children:u}=r(t);if(!u||!i)return n;for(let h=0;h<s.length;h++){const o=s[h];n.push(o[i]);const g=o[u];g&&g.length&&n.push(...a(g))}return n}function y(d){const n=[],s=d||r(e),{key:i,children:u}=r(t);if(!u||!i)return n;for(let h=0;h<s.length;h++){const o=s[h];o.disabled!==!0&&o.selectable!==!1&&n.push(o[i]);const g=o[u];g&&g.length&&n.push(...y(g))}return n}function E(d,n){const s=[],i=n||r(e),{key:u,children:h}=r(t);if(!h||!u)return s;for(let o=0;o<i.length;o++){const g=i[o],_=g[h];d===g[u]?(s.push(g[u]),_&&_.length&&s.push(...a(_))):_&&_.length&&s.push(...E(d,_))}return s}function K(d,n,s){if(!d)return;const i=s||r(e),{key:u,children:h}=r(t);if(!(!h||!u))for(let o=0;o<i.length;o++){const g=i[o],_=g[h];if(g[u]===d){i[o]=O(O({},i[o]),n);break}else _&&_.length&&K(d,n,g[h])}}function c(d=1,n,s=1){if(!d)return[];const i=[],u=n||r(e)||[];for(let h=0;h<u.length;h++){const o=u[h],{key:g,children:_}=r(t),z=g?o[g]:"",P=_?o[_]:[];i.push(z),P&&P.length&&s<d&&(s+=1,i.push(...c(d,P,s)))}return i}function p({parentKey:d=null,node:n,push:s="push"}){const i=ee(r(e));if(!d){i[s](n),e.value=i;return}const{key:u,children:h}=r(t);!h||!u||(ye(i,o=>{if(o[u]===d)return o[h]=o[h]||[],o[h][s](n),!0}),e.value=i)}function k({parentKey:d=null,list:n,push:s="push"}){const i=ee(r(e));if(!(!n||n.length<1))if(d){const{key:u,children:h}=r(t);if(!h||!u)return;ye(i,o=>{if(o[u]===d){o[h]=o[h]||[];for(let g=0;g<n.length;g++)o[h][s](n[g]);return e.value=i,!0}})}else for(let u=0;u<n.length;u++)i[s](n[u])}function v(d,n){if(!d)return;const s=n||r(e),{key:i,children:u}=r(t);if(!(!u||!i))for(let h=0;h<s.length;h++){const o=s[h],g=o[u];if(o[i]===d){s.splice(h,1);break}else g&&g.length&&v(d,o[u])}}function S(d,n,s){return!d&&d!==0?null:((n||r(e)).forEach(u=>{if((s==null?void 0:s.key)||(s==null?void 0:s.key)===0)return s;if(u.key===d){s=u;return}u.children&&u.children.length&&(s=S(d,u.children,s))}),s||null)}return{deleteNodeByKey:v,insertNodeByKey:p,insertNodesByKey:k,filterByLevel:c,updateNodeByKey:K,getAllKeys:a,getChildrenKeys:E,getEnabledKeys:y,getSelectedNode:S}}function Xt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!_t(e)}var Gt=Le({name:"BasicTree",inheritAttrs:!1,props:jt,emits:Pt,setup(e,{attrs:t,slots:a,emit:y,expose:E}){const[K]=Ae("tree"),c=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=pe({startSearch:!1,searchText:"",searchData:[]}),k=be([]),[v]=Dt(),S=I(()=>{const{fieldNames:l}=e;return O({children:"children",title:"title",key:"key"},l)}),d=I(()=>{let l=ie(O(O({blockNode:!0},t),e),{expandedKeys:c.expandedKeys,selectedKeys:c.selectedKeys,checkedKeys:c.checkedKeys,checkStrictly:c.checkStrictly,fieldNames:r(S),"onUpdate:expandedKeys":f=>{c.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{c.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,L)=>{let x=Y(c.checkedKeys);if(gt(x)&&p.startSearch){const b=L.node.eventKey;x=It(x,z(b)),L.checked&&x.push(b),c.checkedKeys=x}else c.checkedKeys=f;const C=Y(c.checkedKeys);y("update:value",C),y("check",C,L)},onRightClick:_e});return kt(l,"treeData","class")}),n=I(()=>p.startSearch?p.searchData:r(k)),s=I(()=>!n.value||n.value.length===0),{deleteNodeByKey:i,insertNodeByKey:u,insertNodesByKey:h,filterByLevel:o,updateNodeByKey:g,getAllKeys:_,getChildrenKeys:z,getEnabledKeys:P,getSelectedNode:ve}=Rt(k,S);function Ee(l,f){return!f&&e.renderIcon&&J(e.renderIcon)?e.renderIcon(l):f}function _e(L){return de(this,arguments,function*({event:l,node:f}){var D;const{rightMenuList:x=[],beforeRightClick:C}=e;let b={event:l,items:[]};if(C&&J(C)){let B=yield C(f,l);Array.isArray(B)?b.items=B:Object.assign(b,B)}else b.items=x;!((D=b.items)!=null&&D.length)||(b.items=b.items.filter(B=>!B.hidden),v(b))})}function H(l){c.expandedKeys=l}function Te(){return c.expandedKeys}function ne(l){c.selectedKeys=l}function Be(){return c.selectedKeys}function ae(l){c.checkedKeys=l}function we(){return c.checkedKeys}function le(l){c.checkedKeys=l?P():[]}function W(l){c.expandedKeys=l?_():[]}function De(l){c.checkStrictly=l}$(()=>e.searchValue,l=>{l!==p.searchText&&(p.searchText=l)},{immediate:!0}),$(()=>e.treeData,l=>{l&&q(p.searchText)});function q(l){if(l!==p.searchText&&(p.searchText=l),y("update:searchValue",l),!l){p.startSearch=!1;return}const{filterFn:f,checkable:L,expandOnSearch:x,checkOnSearch:C,selectedOnSearch:b}=r(e);p.startSearch=!0;const{title:D,key:B}=r(S),N=[];if(p.searchData=St(r(k),w=>{var R,X;const F=f?f(l,w,r(S)):(X=(R=w[D])==null?void 0:R.includes(l))!=null?X:!1;return F&&N.push(w[B]),F},r(S)),x){const w=Kt(p.searchData).map(F=>F[B]);w&&w.length&&H(w)}C&&L&&N.length&&ae(N),b&&N.length&&ne(N)}function Ne(l,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!c.expandedKeys.includes(l))H([...c.expandedKeys,l]);else{const L=[...c.expandedKeys],x=L.findIndex(C=>C===l);x!==-1&&L.splice(x,1),H(L)}}m(()=>{k.value=e.treeData}),xt(()=>{const l=parseInt(e.defaultExpandLevel);l>0?c.expandedKeys=o(l):e.defaultExpandAll&&W(!0)}),m(()=>{c.expandedKeys=e.expandedKeys}),m(()=>{c.selectedKeys=e.selectedKeys}),m(()=>{c.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{c.checkedKeys=Y(e.value||[])},{immediate:!0}),$(()=>c.checkedKeys,()=>{const l=Y(c.checkedKeys);y("update:value",l),y("change",l)}),m(()=>{c.checkStrictly=e.checkStrictly});const Fe={setExpandedKeys:H,getExpandedKeys:Te,setSelectedKeys:ne,getSelectedKeys:Be,setCheckedKeys:ae,getCheckedKeys:we,insertNodeByKey:u,insertNodesByKey:h,deleteNodeByKey:i,updateNodeByKey:g,getSelectedNode:ve,checkAll:le,expandAll:W,filterByLevel:l=>{c.expandedKeys=o(l)},setSearchValue:l=>{q(l)},getSearchValue:()=>p.searchText};function Me(l){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((L,x)=>{var b;let C=!0;return J(L.show)?C=(b=L.show)==null?void 0:b.call(L,l):Ke(L.show)&&(C=L.show),C?A("span",{key:x,class:K("action")},[L.render(l)]):null})}const Ie=I(()=>{const l=ee(n.value);return Ct(l,(f,L)=>{var ce;const x=p.searchText,{highlight:C}=r(e),{title:b,key:D,children:B}=r(S),N=Ee(f,f.icon),w=Tt(f,b),F=x?w.indexOf(x):-1,R=p.startSearch&&!Bt(x)&&C&&F!==-1,X=`color: ${Ke(C)?"#f50":C}`,Oe=R?A("span",{class:(ce=r(d))!=null&&ce.blockNode?`${K("content")}`:""},[A("span",null,[w.substr(0,F)]),A("span",{style:X},[x]),A("span",null,[w.substr(F+x.length)])]):w;return f[b]=A("span",{class:`${K("title")} pl-2`,onClick:Ne.bind(null,f[D],f[B])},[a!=null&&a.title?wt(a,"title",f):A(Q,null,[N&&A(Ht,{icon:N},null),Oe,A("span",{class:K("actions")},[Me(f)])])]),f}),l});return E(Fe),()=>{let l;const{title:f,helpMessage:L,toolbar:x,search:C,checkable:b}=e,D=f||x||C||a.headerTitle,B={height:"calc(100% - 38px)"};return A("div",{class:[K(),"h-full",t.class]},[D&&A(mt,{checkable:b,checkAll:le,expandAll:W,title:f,search:C,toolbar:x,helpMessage:L,onStrictlyChange:De,onSearch:q,searchText:p.searchText},Xt(l=Lt(a))?l:{default:()=>[l]}),A(bt,{wrapperClassName:r(e.treeWrapperClassName),spinning:r(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[ge(A(At,{style:B},{default:()=>[A(vt,Et(r(d),{showIcon:!1,treeData:Ie.value}),null)]}),[[ke,!r(s)]]),ge(A(Se,{image:Se.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ke,r(s)]])]})])}}});export{Gt as _};
